---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import MainLayout from "../layouts/MainLayout.astro";
import H1 from "../components/H1.astro";
import H2 from "../components/H2.astro";
import ExperienceItem from "../components/ExperienceItem.astro";
import BadgeItem from "../components/BadgeItem.astro";
import snowyMountainsBackgroundImage from "../assets/images/snowy-mountains-bg.jpg";
import wishlyLogo from "../assets/images/wishly-logo.png";

const experiences = await getCollection("experience");

const orderedExperiences = [...experiences].sort((a, b) =>
  a.data.startDate > b.data.startDate ? -1 : 1,
);
---

<MainLayout title="Experience | Halvor Teigen">
  <section>
    <Image
      src={snowyMountainsBackgroundImage}
      alt=""
      class="fixed -z-10 top-0 align-top opacity-20 w-full h-full object-cover"
    />
    <main class="m-auto p-4 max-w-3xl text-white">
      <H1 preText="My " gradientText="experience" />
      <H2 text="Timeline" />
      <div class="mb-14">
        <span
          class="hidden md:block absolute mt-3 left-1/2 bg-orange-500 w-0.5 h-[750px]"
        ></span>
        {
          orderedExperiences.map((experience, index) => {
            const {
              startDate,
              endDate,
              heading,
              subHeading,
              description,
              tags,
            } = experience.data;
            return (
              <div
                class={`w-full flex ${
                  index % 2 === 0 ? "justify-end" : "justify-start"
                }`}
              >
                <ExperienceItem
                  {startDate}
                  {endDate}
                  {heading}
                  {subHeading}
                  {description}
                  {tags}
                  align={index % 2 === 0 ? "left" : "right"}
                  classes="xs:max-w-xs"
                />
              </div>
            );
          })
        }
      </div>
      <H2 text="Personal projects" />
      <div class="flex justify-center">
        <BadgeItem
          href="https://github.com/halvorot/wishly-wishlist-app/tree/main"
          image={wishlyLogo}
          imageAlt="Wishly logo"
          title="Wishly - The Wishlist App"
        />
      </div>
    </main>
  </section>
</MainLayout>
