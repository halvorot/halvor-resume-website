---
import Icon from "astro-icon";
---

<button
  id="scroll-to-top-button"
  type="button"
  aria-label="Scroll to top"
  class="fixed bottom-5 right-5 z-50 p-2 bg-neutral-950 bg-opacity-40 rounded-lg"
>
  <Icon name="bi:chevron-up" class="w-5 text-slate-200" />
</button>

<script>
  const scrollToTopButton = document.getElementById("scroll-to-top-button");

  document.addEventListener("scroll", () => {
    if (document.documentElement.scrollTop >= window.innerHeight) {
      scrollToTopButton?.classList.remove("hidden");
    } else {
      if (!scrollToTopButton?.classList.contains("hidden")) {
        scrollToTopButton?.classList.add("hidden");
      }
    }

    const footer = document.querySelector("footer");
    if (footer) {
      const rect = footer?.getBoundingClientRect();
      const footerIsInViewPort =
        rect.top <= (window.innerHeight || document.documentElement.clientHeight)

      if (footerIsInViewPort) {
        scrollToTopButton?.classList.replace("bottom-5", "bottom-28");
        scrollToTopButton?.classList.replace("fixed", "absolute");
      } else {
        scrollToTopButton?.classList.replace("bottom-28", "bottom-5");
        scrollToTopButton?.classList.replace("absolute", "fixed");
      }
    }
  });

  scrollToTopButton?.addEventListener("click", () => {
    window.scrollTo({
      top: 0,
      behavior: "smooth",
    });
  });
</script>
